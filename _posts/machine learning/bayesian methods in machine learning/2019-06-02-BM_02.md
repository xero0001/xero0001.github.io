---
title: Bayesian Methods for ML - 02 Conjugate priors
date: 2019-06-02 10:02:00
categories:
  - machine learning
tags:
  - statistical machine learning
published: true
---

# Analytical Inference

베이지안에서 분모의 evidence를 모델링하는건 쉬운 일이 아니다.

반 고흐의 그림을 모델링 할 수 있겠는가?

## Maximum a posteriori

Evidence의 계산을 우회하기 위한 방법이 MAP이다.

$$\theta_{MP}=argmax_{\theta} P(\theta $$\|$$X)$$

$$\theta_{MP}=argmax_{\theta} \frac{P(X|\theta)P(\theta)}{P(X)}$$

$$\theta_{MP}=argmax_{\theta} P(X|\theta)P(\theta)$$

Evidence는 $$\theta$$와 independent하기 때문에 없애줘도 된다.

## MAP: problems

그러나 MAP는 많은 문제가 있다.

가장 큰 묹는 MAP가 reparametrization에 대해 invariant하다는 것이다.

예를들어 Gaussian Distribution $$P_x$$

Sigmoid function $$f(x)$$

이 있다고 할 때, $$P_{f(x)}$$는 maximum point가 변경된다.

이는 정말 큰 문제다.

다음 문제는 prior를 사용할 수 없다는 것이다.

MAP를 다음 예측의 prior로 사용하려고 하면 

$$P_k (\theta) = \frac{P(x_k|\theta)P_{k-1}(\theta)}{P(x_k)}$$

$$P_k (\theta) = \frac{P(x_k|\theta) \delta(\theta - \theta_{MP})}{P(x_k)}= \delta(\theta- \theta_{MP})$$

또 다시 MAP estimation의 delta function을 얻게 된다.

어떠한 새로운 정보도 얻을 수 없다.

또 다른 문제는 MAP가 untypical point라는 것이다. 주변에 충분한 확률밀도가 없기 때문에.

$$L(\theta) = I[\theta \ne \theta^*] \rightarrow min_{\theta}$$

ideal value에서 끝냈는지에 대해 Indicator로 쓰일 수 있다.

우리는 다른 objective function을 이용할 수 있다.

![111](/assets/figures/ML/BM/111.JPG)

이를 통해 어떤 값을 얻을지를 설정할 수 있다.

마지막으로 credible equation을 계산할 수 없다.

![112](/assets/figures/ML/BM/112.JPG)

## Summary

### Pros

- Easy to compute

### Cons

- Not invariant to reparametrization
- Can't use as a prior
- Finds untypical point
- Can't compute credible intervals

---

# Conjugate distributions

Evidence 계산을 피하는 또 다른 방법은?

![113](/assets/figures/ML/BM/113.JPG)

Likelihood는 model에 의해, Evidence는 data에 의해 고정되어있다.

우리가 선택할 수 있는 것은 prior다.

이 선택을 통해 posterior를 쉽게 선택할 수 있도록 해보자.

prior는 likelihood의 conjugate로 알려져있다.

![114](/assets/figures/ML/BM/114.JPG)

prior와 posterior가 같은 종류의 distribution이면,

예를들어 prior가 어떤 평균과 분산의 정규분포라면 posterior도 어떤 다른 평균과 분산의 정규분포로 여긴다.

![115](/assets/figures/ML/BM/115.JPG)

likelihood가 정규분포라면?

conjugate prior는? 만약 정규분포를 선택한다면?

![116](/assets/figures/ML/BM/116.JPG)

둘을 곱해서 하나의 통합된 방식으로 리메이크하면 어떨까?

다시 정규분포가된다.(파랑과 오렌지 곱해서 초록이됨)

정규분포는 exponential 함수라서 곱하면 모양이 합쳐진다.

![117](/assets/figures/ML/BM/117.JPG)

a와 b로 파라미터화되어 posterior가 생성된다.

## Example

![118](/assets/figures/ML/BM/118.JPG)

Likelihood의 평균이 $$\theta$$면 conjugate.

---

# Distributions: Gamma

두개의 파라미터에 의해 parameterized된다.

$$\Gamma(\gamma | a,b) = \frac{b^a}{\Gamma(a)}\gamma^{a-1}e^{-b \gamma}$$

여기서 $$\gamma, a, b, \gt 0$$ 모두 양수!

